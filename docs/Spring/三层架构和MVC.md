# 三层架构和MVC

<a name="grVFS"></a>
### 什么是三层架构
三层架构是指：**视图层 View**、**服务层 Service**，与**持久层 DAO**。它们分别完成不同的功能。

- View 层：用于接收用户提交请求的代码
- Service 层：系统的业务逻辑主要在这里完成
- DAO 层：直接操作数据库的代码

为了更好的降低各层间的耦合度，在三层架构程序设计中，采用面向抽象编程。即上层对下层的调用，是通过接口实现的。而下层对上层的真正服务提供者，是下层接口的实现类。服务标准（接口）是相同的，服务提供者（实现类）可以更换。这就实现了层间解耦合。

![](https://cdn.nlark.com/yuque/0/2019/png/291118/1564036939705-353cf693-0147-4a70-94d4-e58346715036.png#align=left&display=inline&height=57&originHeight=57&originWidth=555&size=0&status=done&width=555)

<a name="23TZF"></a>
### 什么是MVC
MVC，即 **Model 模型**、**View 视图**，及 **Controller 控制器**。

- View：视图，为用户提供使用界面，与用户直接进行交互。
- Model：模型，承载数据，并对用户提交请求进行计算的模块。其分为两类，一类称为数据承载 Bean，一类称为业务处理 Bean。所谓数据承载 Bean 是指实体类，专门用户承载业务数据的，如 Student、User 等。而业务处理 Bean 则是指 Service 或 Dao 对象， 专门用于处理用户提交请求的。
- Controller：控制器，用于将用户请求转发给相应的 Model 进行处理，并根据 Model 的计算结果向用户提供相应响应。
<a name="5qnxc"></a>
#### MVC 架构程序的工作流程

- 用户通过 View 页面向服务端提出请求，可以是表单请求、超链接请求、AJAX 请求等
- 服务端 Controller 控制器接收到请求后对请求进行解析，找到相应的 Model 对用户请求进行处理
- Model 处理后，将处理结果再交给 Controller
- Controller 在接到处理结果后，根据处理结果找到要作为向客户端发回的响应 View 页面。页面经渲染（数据填充）后，再发送给客户端。

![](https://cdn.nlark.com/yuque/0/2019/png/291118/1564037141456-8f81b915-30c5-4151-9d45-dfbae6640130.png#align=left&display=inline&height=199&originHeight=199&originWidth=375&size=0&status=done&width=375)

<a name="6irDG"></a>
### 三层架构 + MVC 示意图

![](https://cdn.nlark.com/yuque/0/2019/png/291118/1564037168899-e1c159b2-e5f0-4309-91ba-aa36b4836a6e.png#align=left&display=inline&height=204&originHeight=204&originWidth=467&size=0&status=done&width=467)

**三层架构 和 MVC 的目的：****高内聚，低耦合**<br />在软件设计中通常用耦合度和内聚度作为衡量模块独立程度的标准。划分模块的一个准则是高内聚低耦合。<br />从模块粒度来看，高内聚：尽可能类的每个成员方法只完成一件事（最大限度的聚合）； 低耦合：减少类内部，一个成员方法调用另一个成员方法。<br />从类角度来看， 高内聚低耦合：减少类内部，对其他类的调用；<br />从功能块来看， 高内聚低耦合：减少模块之间的交互复杂度（接口数量，参数数据）<br />即横向：类与类之间、模块与模块之间；纵向：层次之间；尽可能，内容内聚，数据耦合。

**降低耦合度的方法**<br />1、少使用类的继承，多用接口隐藏实现的细节。 Java面向对象编程引入接口除了支持多态外， 隐藏实现细节也是其中一个目的。<br />2、模块的功能化分尽可能的单一，道理也很简单，功能单一的模块供其它模块调用的机会就少。（其实这是高内聚的一种说法，高内聚低耦合一般同时出现）。<br />3、遵循一个定义只在一个地方出现。<br />4、少使用全局变量。<br />5、类属性和方法的声明少用public，多用private关键字。<br />6、多用设计模式，比如采用MVC的设计模式就可以降低界面与业务逻辑的耦合度。<br />7、尽量不用“硬编码”的方式写程序，同时也尽量避免直接用SQL语句操作数据库。<br />8、最后当然就是避免直接操作或调用其它模块或类（内容耦合）；如果模块间必须存在耦合，原则上尽量使用数据耦合，少用控制耦合，限制公共耦合的范围，避免使用内容耦合。<br />**增强内聚度方法**<br />1、模块只对外暴露最小限度的接口，形成最低的依赖关系。<br />2、只要对外接口不变，模块内部的修改，就不得影响其他模块。<br />3、删除一个模块，应当只影响有依赖关系的其他模块，而不应该影响其他无关部分。
